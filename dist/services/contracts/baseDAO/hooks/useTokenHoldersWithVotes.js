'use strict';Object.defineProperty(exports,'__esModule',{value:true});exports.useTokenHoldersWithVotes=void 0;const bignumber_js_1=require('bignumber.js');const react_1=require('react');const useDAO_1=require('../../../services/dao/hooks/useDAO');const useProposals_1=require('../../../services/dao/hooks/useProposals');const useTokenHoldersWithVotes=contractAddress=>{const {isLoading:daoIsLoading,error:daoError,ledger}=(0,useDAO_1.useDAO)(contractAddress);const {data:proposals,isLoading:proposalsIsLoading,error:proposalsError}=(0,useProposals_1.useProposals)(contractAddress);const tokenHoldersWithVotes=(0,react_1.useMemo)(()=>{if(!proposals||!ledger){return[];}return ledger.map(tokenHolder=>{let proposalsVoted=0;let votes=new bignumber_js_1.BigNumber(0);proposals.forEach(proposal=>{const voter=proposal.voters.find(voter=>voter.address.toLowerCase()===tokenHolder.holder.address.toLowerCase());if(voter){votes=votes.plus(voter.value);proposalsVoted+=1;}});return Object.assign(Object.assign({},tokenHolder),{votes,proposalsVoted});});},[proposals,ledger]);return{data:tokenHoldersWithVotes,isLoading:proposalsIsLoading||daoIsLoading,error:proposalsError||daoError};};exports.useTokenHoldersWithVotes=useTokenHoldersWithVotes;