'use strict';var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{'default':mod};};Object.defineProperty(exports,'__esModule',{value:true});exports.RegistryTable=void 0;const jsx_runtime_1=require('react/jsx-runtime');const react_1=require('react');const core_1=require('@material-ui/core');const dayjs_1=__importDefault(require('dayjs'));const ItemDialog_1=require('../../../components/ItemDialog');const OverflowCell_1=require('./OverflowCell');const ContentContainer_1=require('../../../components/ContentContainer');const localizedFormat=require('dayjs/plugin/localizedFormat');dayjs_1.default.extend(localizedFormat);const titles=['Registry Items','Value','Last Updated'];const MobileTableHeader=(0,core_1.styled)(core_1.Grid)({width:'100%',padding:20,borderBottom:'0.3px solid #3D3D3D'});const MobileTableRow=(0,core_1.styled)(core_1.Grid)({padding:'30px',borderBottom:'0.3px solid #3D3D3D'});const OverflowItem=(0,core_1.styled)(core_1.Grid)({whiteSpace:'nowrap',overflow:'hidden',textOverflow:'ellipsis',maxWidth:300});const TableContainer=(0,core_1.styled)(ContentContainer_1.ContentContainer)({width:'100%'});const titleDataMatcher=(title,rowData)=>{switch(title){case'Registry Items':return rowData.key;case'Value':return rowData.value;case'Last Updated':return rowData.lastUpdated||'-';}};const MobileRegistryTable=({data})=>{return(0,jsx_runtime_1.jsxs)(core_1.Grid,{container:true,direction:'column',alignItems:'center',children:[(0,jsx_runtime_1.jsx)(MobileTableHeader,{item:true,children:(0,jsx_runtime_1.jsx)(core_1.Typography,{align:'center',variant:'h4',color:'textPrimary',children:'Registry'})}),data.map((rowData,i)=>(0,jsx_runtime_1.jsxs)(MobileTableRow,{item:true,container:true,direction:'column',alignItems:'center',onClick:()=>rowData.onClickItem(rowData.row),style:{gap:19},children:[titles.map((title,j)=>(0,jsx_runtime_1.jsxs)(OverflowItem,{item:true,children:[(0,jsx_runtime_1.jsx)(core_1.Typography,{variant:'h6',color:'secondary',align:'center',children:title==='Registry Items'?'Proposal Key':title}),(0,jsx_runtime_1.jsx)(core_1.Typography,{variant:'h6',color:'textPrimary',align:'center',children:titleDataMatcher(title,rowData.row)})]},`registryMobileItem-${j}`)),(0,jsx_runtime_1.jsx)(core_1.Grid,{item:true,children:(0,jsx_runtime_1.jsx)(core_1.Button,{variant:'contained',color:'secondary',onClick:e=>{e.stopPropagation();rowData.row.onClick();},children:'Edit'})})]},`registryMobile-${i}`))]});};const DesktopRegistryTable=({data})=>{return(0,jsx_runtime_1.jsxs)(core_1.Table,{children:[(0,jsx_runtime_1.jsx)(core_1.TableHead,{children:(0,jsx_runtime_1.jsx)(core_1.TableRow,{children:titles.map((title,i)=>(0,jsx_runtime_1.jsx)(core_1.TableCell,{children:title},`registrytitle-${i}`))})}),(0,jsx_runtime_1.jsx)(core_1.TableBody,{children:data.map((rowData,i)=>(0,jsx_runtime_1.jsxs)(core_1.TableRow,{onClick:()=>rowData.onClickItem(rowData.row),children:[(0,jsx_runtime_1.jsx)(core_1.TableCell,{children:rowData.row.key.toUpperCase()}),(0,jsx_runtime_1.jsx)(OverflowCell_1.OverflowCell,{children:rowData.row.value}),(0,jsx_runtime_1.jsx)(core_1.TableCell,{children:rowData.row.lastUpdated?(0,dayjs_1.default)(rowData.row.lastUpdated).format('L'):'-'}),(0,jsx_runtime_1.jsx)(core_1.TableCell,{align:'right',children:(0,jsx_runtime_1.jsx)(core_1.Button,{variant:'contained',color:'secondary',onClick:e=>{e.stopPropagation();rowData.row.onClick();},children:'Edit'})})]},`registryrow-${i}`))})]});};const RegistryTable=({data:propsData})=>{const theme=(0,core_1.useTheme)();const isSmall=(0,core_1.useMediaQuery)(theme.breakpoints.down('sm'));const [selectedItem,setSelectedItem]=(0,react_1.useState)();const [open,setOpen]=(0,react_1.useState)(false);const onClickItem=row=>{setSelectedItem(row);setOpen(true);};const data=(0,react_1.useMemo)(()=>{if(!propsData){return[];}return propsData.map(rowData=>({row:rowData,onClickItem:onClickItem}));},[propsData]);return(0,jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment,{children:[(0,jsx_runtime_1.jsx)(TableContainer,{item:true,children:isSmall?(0,jsx_runtime_1.jsx)(MobileRegistryTable,{data:data}):(0,jsx_runtime_1.jsx)(DesktopRegistryTable,{data:data})}),(0,jsx_runtime_1.jsx)(ItemDialog_1.RegistryItemDialog,{item:selectedItem||{key:'',value:''},open:open,handleClose:()=>setOpen(false)})]});};exports.RegistryTable=RegistryTable;