'use strict';Object.defineProperty(exports,'__esModule',{value:true});exports.NFTs=void 0;const jsx_runtime_1=require('react/jsx-runtime');const core_1=require('@material-ui/core');const NFT_1=require('../../components/NFT');const NFTDialog_1=require('../../components/NFTDialog');const ProposalForm_1=require('../../components/ProposalForm');const UserBadge_1=require('../../components/UserBadge');const react_1=require('react');const useTezos_1=require('../../../../services/beacon/hooks/useTezos');const useDAOHoldings_1=require('../../../../services/contracts/baseDAO/hooks/useDAOHoldings');const useDAO_1=require('../../../../services/services/dao/hooks/useDAO');const ContentContainer_1=require('../../components/ContentContainer');const router_1=require('../DAO/router');const useCycleInfo_1=require('../../../../services/contracts/baseDAO/hooks/useCycleInfo');const SmallButton_1=require('../../../common/SmallButton');const utils_1=require('../../../../services/contracts/utils');const Card=(0,core_1.styled)(ContentContainer_1.ContentContainer)({boxSizing:'border-box',padding:30,width:325,minHeight:500,cursor:'pointer'});const FullWidthContainer=(0,core_1.styled)(core_1.Grid)({width:'100%'});const ImgContainer=(0,core_1.styled)(core_1.Box)({height:246,width:'100%'});const NFTId=(0,core_1.styled)(core_1.Typography)({fontSize:14,fontWeight:300});const NFTTitle=(0,core_1.styled)(core_1.Typography)({fontWeight:500});const NFTs=()=>{const theme=(0,core_1.useTheme)();const daoId=(0,router_1.useDAOID)();const {data:dao}=(0,useDAO_1.useDAO)(daoId);const {nftHoldings}=(0,useDAOHoldings_1.useDAONFTHoldings)(daoId);const [openTransfer,setOpenTransfer]=(0,react_1.useState)(false);const {account}=(0,useTezos_1.useTezos)();const [defaultValues,setDefaultValues]=(0,react_1.useState)();const [selectedNFT,setSelectedNFT]=(0,react_1.useState)();const isMobileSmall=(0,core_1.useMediaQuery)(theme.breakpoints.down('sm'));const onClickNFT=nft=>{setSelectedNFT(nft);};const onCloseDialog=()=>{setSelectedNFT(undefined);};const onOpenTransferModal=nft=>{setDefaultValues({nftTransferForm:{isBatch:false,transfers:[{recipient:account,amount:1,asset:nft}]}});setOpenTransfer(true);};const onClick=(e,nft)=>{e.stopPropagation();onOpenTransferModal(nft);};const onCloseTransfer=()=>{setOpenTransfer(false);};const shouldDisable=(0,useCycleInfo_1.useIsProposalButtonDisabled)(daoId);return(0,jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment,{children:[(0,jsx_runtime_1.jsx)(core_1.Grid,{container:true,direction:'column',style:{gap:42},children:(0,jsx_runtime_1.jsx)(core_1.Grid,{item:true,children:(0,jsx_runtime_1.jsx)(core_1.Grid,{container:true,justifyContent:isMobileSmall?'center':'flex-start',style:{gap:12},children:!nftHoldings?(0,jsx_runtime_1.jsx)(jsx_runtime_1.Fragment,{children:(0,jsx_runtime_1.jsx)(core_1.Grid,{container:true,direction:'row',justifyContent:'center',children:(0,jsx_runtime_1.jsx)(core_1.CircularProgress,{color:'secondary'})})}):(0,jsx_runtime_1.jsx)(jsx_runtime_1.Fragment,{children:nftHoldings.map((nft,i)=>(0,jsx_runtime_1.jsxs)(Card,{item:true,container:true,xs:isMobileSmall?12:undefined,direction:'column',style:{gap:20},onClick:()=>onClickNFT(nft),children:[(0,jsx_runtime_1.jsx)(core_1.Grid,{item:true,children:(0,jsx_runtime_1.jsxs)(core_1.Grid,{container:true,direction:'column',style:{gap:18},alignItems:'center',children:[(0,jsx_runtime_1.jsx)(FullWidthContainer,{item:true,children:nft.token.firstCreator?(0,jsx_runtime_1.jsx)(UserBadge_1.UserBadge,{size:35,address:nft.token.firstCreator,short:true}):(0,jsx_runtime_1.jsx)(core_1.Typography,{color:'textPrimary',variant:'body1',children:'Unknown'})}),(0,jsx_runtime_1.jsx)(core_1.Grid,{item:true,children:(0,jsx_runtime_1.jsx)(ImgContainer,{children:(0,jsx_runtime_1.jsx)(NFT_1.NFT,{qmHash:nft.token.artifact_hash,mediaType:nft.token.mediaType,name:nft.token.name})})}),(0,jsx_runtime_1.jsxs)(FullWidthContainer,{item:true,container:true,direction:'row',justifyContent:'space-between',children:[(0,jsx_runtime_1.jsxs)(NFTId,{color:'textPrimary',children:[nft.token.symbol,'#',nft.token.id]}),(0,jsx_runtime_1.jsxs)(NFTId,{color:'textPrimary',children:['#',nft.token.token_id]})]})]})}),(0,jsx_runtime_1.jsx)(core_1.Grid,{item:true,children:(0,jsx_runtime_1.jsxs)(core_1.Grid,{container:true,direction:'column',style:{gap:20},children:[(0,jsx_runtime_1.jsx)(core_1.Grid,{item:true,children:(0,jsx_runtime_1.jsx)(NFTTitle,{color:'textPrimary',variant:'h4',children:nft.token.name})}),(0,jsx_runtime_1.jsx)(core_1.Grid,{item:true,children:(0,jsx_runtime_1.jsxs)(core_1.Typography,{color:'secondary',style:{marginBottom:16},children:[(0,utils_1.parseUnits)(nft.token.supply,nft.token.decimals).toString(),' ',nft.token.symbol]})}),(0,jsx_runtime_1.jsx)(core_1.Grid,{item:true,container:true,direction:'row',justifyContent:'center',children:(0,jsx_runtime_1.jsx)(SmallButton_1.SmallButton,{variant:'contained',color:'secondary',size:'small',onClick:e=>onClick(e,nft.token),disabled:shouldDisable,children:'Transfer'})})]})})]},`nft-${i}`))})})})}),(0,jsx_runtime_1.jsx)(NFTDialog_1.NFTDialog,{open:!!selectedNFT,onClose:onCloseDialog,nft:selectedNFT===null||selectedNFT===void 0?void 0:selectedNFT.token}),(0,jsx_runtime_1.jsx)(ProposalForm_1.ProposalFormContainer,{open:openTransfer,handleClose:onCloseTransfer,defaultValues:defaultValues,defaultTab:1})]});};exports.NFTs=NFTs;