'use strict';var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||('get'in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k];}};}Object.defineProperty(o,k2,desc);}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k];});var __setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,'default',{enumerable:true,value:v});}:function(o,v){o['default']=v;});var __importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)if(k!=='default'&&Object.prototype.hasOwnProperty.call(mod,k))__createBinding(result,mod,k);__setModuleDefault(result,mod);return result;};Object.defineProperty(exports,'__esModule',{value:true});exports.DAOList=void 0;const jsx_runtime_1=require('react/jsx-runtime');const core_1=require('@material-ui/core');const Toolbar_1=require('../../components/Toolbar');const TabPanel_1=require('../../components/TabPanel');const react_1=__importStar(require('react'));const useTezos_1=require('../../../../services/beacon/hooks/useTezos');const useAllDAOs_1=require('../../../../services/services/dao/hooks/useAllDAOs');const ConnectMessage_1=require('./components/ConnectMessage');const DAOItem_1=require('./components/DAOItem');const Searchbar_1=require('./components/Searchbar');const MainButton_1=require('../../../common/MainButton');const icons_1=require('@material-ui/icons');const PageContainer=(0,core_1.styled)('div')(({theme})=>({width:'1000px',height:'100%',margin:'auto',['@media (max-width: 1425px)']:{},['@media (max-width:1335px)']:{},['@media (max-width:1167px)']:{width:'86vw'},['@media (max-width:1030px)']:{},['@media (max-width:960px)']:{}}));const StyledTab=(0,core_1.styled)(core_1.Button)(({theme,isSelected})=>({'fontSize':16,'color':isSelected?theme.palette.primary.dark:'#fff','backgroundColor':isSelected?theme.palette.secondary.main:theme.palette.primary.main,'&:hover':{backgroundColor:isSelected?theme.palette.secondary.main:theme.palette.secondary.dark}}));const Search=(0,core_1.styled)(core_1.Grid)({width:'49.5%',['@media (max-width: 645px)']:{width:'100%',marginTop:'14px'}});const DAOItemGrid=(0,core_1.styled)(core_1.Grid)({gap:'18px',['@media (max-width: 1155px)']:{gap:'16px'},['@media (max-width:960px)']:{gap:'14px'},['@media (max-width:830px)']:{gap:'12px'}});const DAOItemCard=(0,core_1.styled)(core_1.Grid)({flexBasis:'49%',['@media (max-width:760px)']:{minWidth:'100%'}});const BannerContainer=(0,core_1.styled)(core_1.Grid)(({theme})=>({background:theme.palette.primary.main,padding:'30px 48px',borderRadius:8,display:'inline-block',[theme.breakpoints.down('md')]:{padding:'28px 38px'}}));const LinkText=(0,core_1.styled)(core_1.Typography)(({theme})=>({fontSize:18,fontWeight:200,lineHeight:'146.3%',cursor:'default',[theme.breakpoints.down('sm')]:{fontSize:16},[theme.breakpoints.down('xs')]:{fontSize:13}}));const ExternalLink=(0,core_1.styled)(core_1.Typography)({'display':'inline','cursor':'pointer','fontWeight':200,'&:hover':{textDecoration:'underline'}});const ExternalLinkIcon=(0,core_1.styled)(icons_1.LaunchOutlined)({fontSize:14,marginBottom:2});const DAOList=()=>{const {network,account,tezos}=(0,useTezos_1.useTezos)();const {data:daos,isLoading}=(0,useAllDAOs_1.useAllDAOs)(network);const theme=(0,core_1.useTheme)();const isMobileExtraSmall=(0,core_1.useMediaQuery)(theme.breakpoints.down('xs'));const isMobileSmall=(0,core_1.useMediaQuery)(theme.breakpoints.down('mobile'));const [searchText,setSearchText]=(0,react_1.useState)('');const [selectedTab,setSelectedTab]=react_1.default.useState(0);const currentDAOs=(0,react_1.useMemo)(()=>{if(daos){const formattedDAOs=daos.map(dao=>({id:dao.address,name:dao.name,symbol:dao.token.symbol,votingAddresses:dao.ledgers?dao.ledgers.map(l=>l.holder.address):[],dao_type:{name:dao.dao_type.name}})).sort((a,b)=>b.votingAddresses.length-a.votingAddresses.length);if(searchText){return formattedDAOs.filter(formattedDao=>formattedDao.name&&formattedDao.name.toLowerCase().includes(searchText.toLowerCase())||formattedDao.symbol&&formattedDao.symbol.toLowerCase().includes(searchText.toLowerCase()));}return formattedDAOs;}return[];},[daos,searchText]);const filterDAOs=filter=>{setSearchText(filter.trim());};const handleChangeTab=newValue=>{setSelectedTab(newValue);};return(0,jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment,{children:[(0,jsx_runtime_1.jsx)(Toolbar_1.Navbar,{disableMobileMenu:true}),(0,jsx_runtime_1.jsx)(PageContainer,{children:(0,jsx_runtime_1.jsxs)(core_1.Grid,{container:true,style:{gap:42},direction:'column',children:[(0,jsx_runtime_1.jsx)(core_1.Grid,{item:true,children:(0,jsx_runtime_1.jsxs)(core_1.Grid,{container:true,justifyContent:isMobileExtraSmall?'center':'space-between',alignItems:'center',style:{gap:42},children:[(0,jsx_runtime_1.jsx)(Search,{children:(0,jsx_runtime_1.jsx)(Searchbar_1.SearchInput,{search:filterDAOs})}),(0,jsx_runtime_1.jsx)(core_1.Grid,{item:true,children:(0,jsx_runtime_1.jsxs)(core_1.Grid,{container:true,style:{gap:22},justifyContent:'center',children:[(0,jsx_runtime_1.jsx)(core_1.Grid,{item:true,children:(0,jsx_runtime_1.jsx)(core_1.Grid,{container:true,justifyContent:'center',alignItems:'center',style:{height:'100%'},children:(0,jsx_runtime_1.jsx)(core_1.Grid,{item:true,children:(0,jsx_runtime_1.jsxs)(core_1.Typography,{style:{fontSize:'18px'},color:'textPrimary',children:[(daos===null||daos===void 0?void 0:daos.length)||0,' DAOs']})})})}),(0,jsx_runtime_1.jsx)(core_1.Grid,{item:true,children:(0,jsx_runtime_1.jsx)(core_1.Link,{underline:'none',href:`/creator`,children:(0,jsx_runtime_1.jsx)(MainButton_1.MainButton,{variant:'contained',color:'secondary',children:'Create DAO'})})})]})})]})}),(0,jsx_runtime_1.jsx)(core_1.Grid,{item:true,children:(0,jsx_runtime_1.jsx)(core_1.Grid,{container:true,children:(0,jsx_runtime_1.jsx)(core_1.Grid,{item:true,children:(0,jsx_runtime_1.jsxs)(core_1.Grid,{container:true,children:[(0,jsx_runtime_1.jsx)(core_1.Grid,{item:true,children:(0,jsx_runtime_1.jsx)(StyledTab,{variant:'contained',style:selectedTab!==0?{borderTopRightRadius:0,borderBottomRightRadius:0,zIndex:0}:{borderRadius:4,zIndex:1},disableElevation:true,onClick:()=>handleChangeTab(0),isSelected:selectedTab===0,children:'All'})}),(0,jsx_runtime_1.jsx)(core_1.Grid,{item:true,children:(0,jsx_runtime_1.jsx)(StyledTab,{disableElevation:true,variant:'contained',style:selectedTab!==1?{borderTopLeftRadius:0,borderBottomLeftRadius:0,marginLeft:-1,zIndex:0}:{borderRadius:4,marginLeft:-1,zIndex:1},onClick:()=>handleChangeTab(1),isSelected:selectedTab===1,children:'My DAOs'})})]})})})}),(0,jsx_runtime_1.jsxs)(core_1.Grid,{item:true,children:[(0,jsx_runtime_1.jsx)(TabPanel_1.TabPanel,{value:selectedTab,index:0,children:(0,jsx_runtime_1.jsxs)(DAOItemGrid,{container:true,justifyContent:isMobileSmall?'center':'flex-start',children:[currentDAOs.map((dao,i)=>(0,jsx_runtime_1.jsx)(DAOItemCard,{item:true,children:(0,jsx_runtime_1.jsx)(DAOItem_1.DAOItem,{dao:dao})},`dao-${i}`)),isLoading?(0,jsx_runtime_1.jsx)(core_1.Grid,{item:true,children:(0,jsx_runtime_1.jsx)(core_1.CircularProgress,{color:'secondary'})}):null]})}),(0,jsx_runtime_1.jsx)(TabPanel_1.TabPanel,{value:selectedTab,index:1,children:(0,jsx_runtime_1.jsx)(DAOItemGrid,{container:true,style:{gap:18},justifyContent:isMobileSmall?'center':'flex-start',children:!account?(0,jsx_runtime_1.jsx)(ConnectMessage_1.ConnectMessage,{}):currentDAOs.filter(dao=>dao.votingAddresses.includes(account)).map((dao,i)=>(0,jsx_runtime_1.jsx)(DAOItemCard,{item:true,children:(0,jsx_runtime_1.jsx)(DAOItem_1.DAOItem,{dao:dao})},`mine-${i}`))})})]})]})})]});};exports.DAOList=DAOList;