'use strict';var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||('get'in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k];}};}Object.defineProperty(o,k2,desc);}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k];});var __setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,'default',{enumerable:true,value:v});}:function(o,v){o['default']=v;});var __importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)if(k!=='default'&&Object.prototype.hasOwnProperty.call(mod,k))__createBinding(result,mod,k);__setModuleDefault(result,mod);return result;};var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value);});}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value));}catch(e){reject(e);}}function rejected(value){try{step(generator['throw'](value));}catch(e){reject(e);}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected);}step((generator=generator.apply(thisArg,_arguments||[])).next());});};var __rest=this&&this.__rest||function(s,e){var t={};for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0)t[p]=s[p];if(s!=null&&typeof Object.getOwnPropertySymbols==='function')for(var i=0,p=Object.getOwnPropertySymbols(s);i<p.length;i++){if(e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i]))t[p[i]]=s[p[i]];}return t;};Object.defineProperty(exports,'__esModule',{value:true});exports.DAORouter=exports.useDAOID=void 0;const jsx_runtime_1=require('react/jsx-runtime');const core_1=require('@material-ui/core');const NotFound_1=require('../../components/NotFound');const NotIndexed_1=require('../../components/NotIndexed');const index_1=require('./index');const User_1=require('../User');const react_1=__importStar(require('react'));const react_router_1=require('react-router');const react_router_dom_1=require('react-router-dom');const useTezos_1=require('../../../../services/beacon/hooks/useTezos');const useDAO_1=require('../../../../services/services/dao/hooks/useDAO');const Toolbar_1=require('../../components/Toolbar');const Config_1=require('../Config');const ProposalDetails_1=require('../ProposalDetails');const Proposals_1=require('../Proposals');const Registry_1=require('../Registry');const Treasury_1=require('../Treasury');const PageLayout=(0,core_1.styled)('div')(({theme})=>({background:theme.palette.primary.dark,width:'1000px',margin:'42px auto 0px auto',['@media (max-width: 1425px)']:{},['@media (max-width:1335px)']:{},['@media (max-width:1167px)']:{width:'86vw'},['@media (max-width:1030px)']:{},['@media (max-width:960px)']:{marginTop:0}}));var DAOState;(function(DAOState){DAOState[DAOState['NOT_FOUND']=0]='NOT_FOUND';DAOState[DAOState['NOT_INDEXED']=1]='NOT_INDEXED';DAOState[DAOState['FOUND']=2]='FOUND';}(DAOState||(DAOState={})));const DAORouteContent=({children})=>{const daoId=(0,exports.useDAOID)();const {tezos,network,changeNetwork}=(0,useTezos_1.useTezos)();const {data,error}=(0,useDAO_1.useDAO)(daoId);const [state,setState]=(0,react_1.useState)(DAOState.FOUND);const history=(0,react_router_1.useHistory)();(0,react_1.useEffect)(()=>{;(()=>__awaiter(void 0,void 0,void 0,function*(){if(!data&&!!error){try{yield tezos.contract.at(daoId);setState(DAOState.NOT_INDEXED);}catch(e){setState(DAOState.NOT_FOUND);}}}))();},[data,error,daoId,tezos.contract]);(0,react_1.useEffect)(()=>{if(history&&data&&data.data.network.toLowerCase()!==network.toLowerCase()){changeNetwork(data.data.network.toLowerCase());}},[data,history,network,changeNetwork]);return(0,jsx_runtime_1.jsx)(jsx_runtime_1.Fragment,{children:state===DAOState.NOT_FOUND?(0,jsx_runtime_1.jsx)(NotFound_1.NotFound,{}):state===DAOState.NOT_INDEXED?(0,jsx_runtime_1.jsx)(NotIndexed_1.NotIndexed,{address:daoId}):children});};const DAORoute=_a=>{var {children}=_a,props=__rest(_a,['children']);return(0,jsx_runtime_1.jsx)(react_router_dom_1.Route,Object.assign({},props,{children:(0,jsx_runtime_1.jsx)(DAORouteContent,{children:children})}));};const DAOContext=react_1.default.createContext('');const DAOProvider=({daoId,children})=>{return(0,jsx_runtime_1.jsx)(DAOContext.Provider,{value:daoId,children:children});};const useDAOID=()=>{return(0,react_1.useContext)(DAOContext);};exports.useDAOID=useDAOID;const DAORouter=()=>{const match=(0,react_router_dom_1.useRouteMatch)();const theme=(0,core_1.useTheme)();const {id:daoId}=(0,react_router_dom_1.useParams)();return(0,jsx_runtime_1.jsxs)(DAOProvider,{daoId:daoId,children:[(0,jsx_runtime_1.jsx)(Toolbar_1.Navbar,{}),(0,jsx_runtime_1.jsx)(PageLayout,{children:(0,jsx_runtime_1.jsxs)(react_router_dom_1.Switch,{children:[(0,jsx_runtime_1.jsx)(DAORoute,{path:`${match.url}/proposal/:proposalId`,children:(0,jsx_runtime_1.jsx)(ProposalDetails_1.ProposalDetails,{})}),(0,jsx_runtime_1.jsx)(DAORoute,{path:`${match.url}/proposals`,children:(0,jsx_runtime_1.jsx)(Proposals_1.Proposals,{})}),(0,jsx_runtime_1.jsx)(DAORoute,{path:`${match.url}/treasury`,children:(0,jsx_runtime_1.jsx)(Treasury_1.Treasury,{})}),(0,jsx_runtime_1.jsx)(DAORoute,{path:`${match.url}/registry`,children:(0,jsx_runtime_1.jsx)(Registry_1.Registry,{})}),(0,jsx_runtime_1.jsx)(DAORoute,{path:`${match.url}/user`,children:(0,jsx_runtime_1.jsx)(User_1.User,{})}),(0,jsx_runtime_1.jsx)(DAORoute,{path:`${match.url}/config`,children:(0,jsx_runtime_1.jsx)(Config_1.Config,{})}),(0,jsx_runtime_1.jsx)(DAORoute,{path:`${match.url}/overview`,children:(0,jsx_runtime_1.jsx)(index_1.DAO,{})}),(0,jsx_runtime_1.jsx)(react_router_dom_1.Redirect,{from:`${match.url}`,to:`${match.url}/overview`})]})})]});};exports.DAORouter=DAORouter;