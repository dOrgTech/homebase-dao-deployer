'use strict';var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{'default':mod};};Object.defineProperty(exports,'__esModule',{value:true});exports.VotersProgress=void 0;const jsx_runtime_1=require('react/jsx-runtime');const react_1=require('react');const core_1=require('@material-ui/core');const FormatNumber_1=require('../utils/FormatNumber');const ProgressBar_1=require('./ProgressBar');const useVotesStats_1=require('../hooks/useVotesStats');const bignumber_js_1=__importDefault(require('bignumber.js'));const useProposal_1=require('../../../services/services/dao/hooks/useProposal');const VotesDetailDialog_1=require('./VotesDetailDialog');const GreenDot=(0,core_1.styled)(core_1.Paper)(({theme})=>({width:9,height:9,marginRight:9,background:theme.palette.secondary.main}));const RedDot=(0,core_1.styled)(core_1.Paper)(({theme})=>({width:9,height:9,marginRight:9,background:theme.palette.error.main}));const StatusTitle=(0,core_1.styled)(core_1.Typography)({fontWeight:'bold',marginRight:12});const VotersProgress=({showButton,daoId,proposalId,wrapAll})=>{const theme=(0,core_1.useTheme)();const [open,setOpen]=(0,react_1.useState)(false);const isMobileSmall=(0,core_1.useMediaQuery)(theme.breakpoints.down('sm'));const {data:proposalData}=(0,useProposal_1.useProposal)(daoId,proposalId);const proposal=proposalData;const quorumThreshold=(proposal===null||proposal===void 0?void 0:proposal.quorumThreshold)||new bignumber_js_1.default(0);const upVotes=proposal?proposal.upVotes:new bignumber_js_1.default(0);const downVotes=proposal?proposal.downVotes:new bignumber_js_1.default(0);const {upVotesQuorumPercentage,downVotesQuorumPercentage,upVotesSumPercentage}=(0,useVotesStats_1.useVotesStats)({quorumThreshold,upVotes,downVotes});return(0,jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment,{children:[(0,jsx_runtime_1.jsxs)(core_1.Grid,{item:true,xs:12,container:true,direction:'row',alignItems:'center',spacing:2,children:[(0,jsx_runtime_1.jsxs)(core_1.Grid,{item:true,xs:true,container:true,direction:'row',alignItems:'baseline',justifyContent:'flex-start',children:[(0,jsx_runtime_1.jsxs)(core_1.Grid,{item:true,md:isMobileSmall||wrapAll?12:true,container:true,direction:'row',alignItems:'baseline',wrap:'nowrap',children:[(0,jsx_runtime_1.jsx)(GreenDot,{}),(0,jsx_runtime_1.jsxs)(StatusTitle,{color:'textPrimary',variant:'subtitle2',children:['SUPPORT:',' ']}),(0,jsx_runtime_1.jsxs)(core_1.Typography,{color:'textPrimary',variant:'subtitle2',children:[proposal?upVotes.toString():'-',' (',upVotesQuorumPercentage&&upVotesQuorumPercentage.isGreaterThan(100)?100:(0,FormatNumber_1.formatNumber)(upVotesQuorumPercentage),'%)',' ']})]}),(0,jsx_runtime_1.jsxs)(core_1.Grid,{md:isMobileSmall||wrapAll?12:true,container:true,direction:'row',alignItems:'center',wrap:'nowrap',children:[(0,jsx_runtime_1.jsx)(RedDot,{}),(0,jsx_runtime_1.jsxs)(StatusTitle,{color:'textPrimary',variant:'subtitle2',children:['OPPOSE:',' ']}),(0,jsx_runtime_1.jsxs)(core_1.Typography,{color:'textPrimary',variant:'subtitle2',children:[proposal?downVotes.toString():'-',' (',downVotesQuorumPercentage&&downVotesQuorumPercentage.isGreaterThan(100)?100:(0,FormatNumber_1.formatNumber)(downVotesQuorumPercentage),'%)',' ']})]})]}),showButton?(0,jsx_runtime_1.jsx)(core_1.Grid,{xs:2,container:true,direction:'row',alignItems:'center',justifyContent:'flex-end',children:(0,jsx_runtime_1.jsx)(core_1.Button,{variant:'contained',color:'secondary',size:'small',onClick:()=>setOpen(true),children:'View'})}):null]}),(0,jsx_runtime_1.jsx)(core_1.Grid,{item:true,xs:12,children:(0,jsx_runtime_1.jsx)(ProgressBar_1.MultiColorBar,{variant:'determinate',value:upVotesSumPercentage.toNumber(),color:'secondary'})}),(0,jsx_runtime_1.jsx)(VotesDetailDialog_1.VotesDetailDialog,{daoAddress:daoId,proposalAddress:proposalId,open:open,onClose:()=>setOpen(false)})]});};exports.VotersProgress=VotersProgress;