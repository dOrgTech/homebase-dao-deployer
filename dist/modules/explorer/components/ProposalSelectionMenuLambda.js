'use strict';var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{'default':mod};};Object.defineProperty(exports,'__esModule',{value:true});exports.ProposalSelectionMenuLambda=void 0;const jsx_runtime_1=require('react/jsx-runtime');const lodash_1=__importDefault(require('lodash'));const core_1=require('@material-ui/core');const react_1=require('react');const useDAO_1=require('../../../services/services/dao/hooks/useDAO');const router_1=require('../pages/DAO/router');const ResponsiveDialog_1=require('./ResponsiveDialog');const MainButton_1=require('../../common/MainButton');const ConfigProposalFormLambda_1=require('./ConfigProposalFormLambda');const useDAOLambdas_1=require('../../../services/contracts/baseDAO/hooks/useDAOLambdas');const lambdas_1=require('../../../services/bakingBad/lambdas');const GuardianChangeProposalForm_1=require('./GuardianChangeProposalForm');const ConfigProposalForm_1=require('./ConfigProposalForm');const Content=(0,core_1.styled)(core_1.Grid)({padding:'0 25px'});const defaultOpenSupportedExecuteProposalModal='none';const ProposalSelectionMenuLambda=({open,handleClose})=>{const daoId=(0,router_1.useDAOID)();const {data:dao}=(0,useDAO_1.useDAO)(daoId);const daoLambdas=(0,useDAOLambdas_1.useDAOLambdas)(daoId);const [proposalAction,setProposalAction]=(0,react_1.useState)(ConfigProposalFormLambda_1.ProposalAction.none);const [isExecuteUI,setIsExecuteUI]=(0,react_1.useState)(false);const [openProposalFormLambda,setOpenProposalFormLambda]=(0,react_1.useState)(false);const [openSupportedExecuteProposalModalKey,setOpenSupportedExecuteProposalModal]=(0,react_1.useState)(defaultOpenSupportedExecuteProposalModal);const toggleExecuteUI=()=>{setIsExecuteUI(!isExecuteUI);};const onClose=()=>{setIsExecuteUI(false);handleClose();};const handleGoBack=()=>{setIsExecuteUI(false);};const handleOpenCustomProposalModal=key=>{setProposalAction(key);setOpenProposalFormLambda(true);onClose();};const handleCloseCustomProposalModal=()=>{setProposalAction(ConfigProposalFormLambda_1.ProposalAction.none);setOpenProposalFormLambda(false);};const handleOpenSupportedExecuteProposalModal=lambdaKey=>{setOpenSupportedExecuteProposalModal(lambdaKey);onClose();};const handleCloseSupportedExecuteProposalModal=()=>{setOpenSupportedExecuteProposalModal(defaultOpenSupportedExecuteProposalModal);};const renderMainMenuContent=()=>(0,jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment,{children:[(0,jsx_runtime_1.jsx)(core_1.Grid,{item:true,children:(0,jsx_runtime_1.jsx)(core_1.Typography,{style:{fontWeight:300},color:'textPrimary',children:'Which proposal would you like to create?'})}),(0,jsx_runtime_1.jsxs)(core_1.Grid,{container:true,justifyContent:'center',style:{gap:20},direction:'column',children:[(0,jsx_runtime_1.jsx)(MainButton_1.MainButton,{variant:'contained',onClick:()=>handleOpenCustomProposalModal(ConfigProposalFormLambda_1.ProposalAction.new),children:'Add Lambda'}),(0,jsx_runtime_1.jsx)(MainButton_1.MainButton,{variant:'contained',color:'secondary',onClick:()=>handleOpenCustomProposalModal(ConfigProposalFormLambda_1.ProposalAction.remove),children:'Remove Lambda'}),(0,jsx_runtime_1.jsx)(MainButton_1.MainButton,{variant:'contained',color:'secondary',onClick:toggleExecuteUI,children:'Execute Lambda'})]})]});const renderExecuteMenuContent=()=>(0,jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment,{children:[(0,jsx_runtime_1.jsx)(core_1.Grid,{item:true,children:(0,jsx_runtime_1.jsx)(core_1.Typography,{style:{fontWeight:300},color:'textPrimary',children:'Execute Lambda'})}),(0,jsx_runtime_1.jsxs)(core_1.Grid,{container:true,justifyContent:'center',style:{gap:20},direction:'column',children:[lodash_1.default.map(daoLambdas,lambda=>{if(lambda.key===lambdas_1.SupportedLambdaProposalKey.UpdateReceiversProposal||lambda.key===lambdas_1.SupportedLambdaProposalKey.TransferProposal||lambda.key===lambdas_1.SupportedLambdaProposalKey.UpdateContractDelegateProposal){return null;}return(0,jsx_runtime_1.jsx)(MainButton_1.MainButton,{variant:'contained',onClick:()=>handleOpenSupportedExecuteProposalModal(lambda.key),children:lodash_1.default.startCase(lambda.key)});}),(0,jsx_runtime_1.jsx)(MainButton_1.MainButton,{variant:'contained',color:'secondary',onClick:()=>handleOpenCustomProposalModal(ConfigProposalFormLambda_1.ProposalAction.execute),children:'Custom Proposal'})]})]});return(0,jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment,{children:[(0,jsx_runtime_1.jsx)(ResponsiveDialog_1.ResponsiveDialog,{open:open,onClose:onClose,onGoBack:isExecuteUI?handleGoBack:undefined,title:'Add New Proposal',children:(0,jsx_runtime_1.jsx)(Content,{container:true,direction:'column',style:{gap:32},children:dao?(0,jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment,{children:[isExecuteUI?renderExecuteMenuContent():null,!isExecuteUI?renderMainMenuContent():null]}):(0,jsx_runtime_1.jsx)(jsx_runtime_1.Fragment,{children:(0,jsx_runtime_1.jsx)(core_1.Grid,{container:true,justifyContent:'center',style:{gap:20},direction:'column',children:(0,jsx_runtime_1.jsx)(core_1.Typography,{color:'textPrimary',children:'Something went wrong! please try again later.'})})})})}),(0,jsx_runtime_1.jsx)(ConfigProposalFormLambda_1.ProposalFormLambda,{action:proposalAction,open:openProposalFormLambda,handleClose:handleCloseCustomProposalModal}),(0,jsx_runtime_1.jsx)(ConfigProposalForm_1.ConfigProposalForm,{open:openSupportedExecuteProposalModalKey===lambdas_1.SupportedLambdaProposalKey.ConfigurationProposal,handleClose:handleCloseSupportedExecuteProposalModal}),(0,jsx_runtime_1.jsx)(GuardianChangeProposalForm_1.GuardianChangeProposalForm,{open:openSupportedExecuteProposalModalKey===lambdas_1.SupportedLambdaProposalKey.UpdateGuardianProposal,handleClose:handleCloseSupportedExecuteProposalModal})]});};exports.ProposalSelectionMenuLambda=ProposalSelectionMenuLambda;