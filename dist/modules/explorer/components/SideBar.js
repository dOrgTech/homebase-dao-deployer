'use strict';Object.defineProperty(exports,'__esModule',{value:true});exports.SideBar=exports.debounce=void 0;const jsx_runtime_1=require('react/jsx-runtime');const core_1=require('@material-ui/core');const react_1=require('react');const home_svg_1=require('../../../assets/logos/home.svg');const voting_svg_1=require('../../../assets/logos/voting.svg');const treasury_svg_1=require('../../../assets/logos/treasury.svg');const list_svg_1=require('../../../assets/logos/list.svg');const user_svg_1=require('../../../assets/logos/user.svg');const react_router_dom_1=require('react-router-dom');const useDAO_1=require('../../../services/services/dao/hooks/useDAO');const useTezos_1=require('../../../services/beacon/hooks/useTezos');const router_1=require('../pages/DAO/router');const debounce=(callback,waitFor)=>{let timeout=0;return(...args)=>{let result;clearTimeout(timeout);timeout=setTimeout(()=>{result=callback(...args);},waitFor);return result;};};exports.debounce=debounce;const Bar=(0,core_1.styled)(core_1.Grid)(({theme})=>({minWidth:102,borderRight:`2px solid ${theme.palette.primary.light}`,[theme.breakpoints.down('xs')]:{width:'100%',borderBottom:`2px solid ${theme.palette.primary.light}`,borderRight:`unset`}}));const SidebarButton=(0,core_1.styled)(core_1.IconButton)(({theme})=>({paddingTop:32,width:'100%',[theme.breakpoints.down('xs')]:{paddingTop:12}}));const IconContainer=(0,core_1.styled)('span')(({theme})=>({'& > svg > *':{fill:({isSelected})=>isSelected?theme.palette.secondary.main:theme.palette.text.secondary}}));const ButtonIcon=({Icon,isSelected,handler})=>{return(0,jsx_runtime_1.jsx)(SidebarButton,{onClick:handler,children:(0,jsx_runtime_1.jsx)(IconContainer,{isSelected:isSelected,children:(0,jsx_runtime_1.jsx)(Icon,{})})});};const StyledBottomBar=(0,core_1.styled)(core_1.Grid)(({theme,visible})=>({position:'fixed',height:55,bottom:visible?0:-55,backgroundColor:theme.palette.primary.main,borderTop:`2px solid ${theme.palette.primary.light}`,zIndex:10000,width:'100%',transition:'bottom 0.5s'}));const BottomNavBar=({children})=>{const [prevScrollPos,setPrevScrollPos]=(0,react_1.useState)(0);const [visible,setVisible]=(0,react_1.useState)(true);(0,react_1.useEffect)(()=>{const handleScroll=(0,exports.debounce)(()=>{const currentScrollPos=123;setVisible(prevScrollPos>currentScrollPos||currentScrollPos<10);setPrevScrollPos(currentScrollPos);},100);},[prevScrollPos,visible]);return(0,jsx_runtime_1.jsx)(StyledBottomBar,{container:true,direction:'row',justifyContent:'space-evenly',visible:visible,children:children});};const SideNavBar=({children})=>{const theme=(0,core_1.useTheme)();const isMobileExtraSmall=(0,core_1.useMediaQuery)(theme.breakpoints.down('xs'));return(0,jsx_runtime_1.jsx)(Bar,{item:true,children:(0,jsx_runtime_1.jsx)(core_1.Grid,{container:true,direction:isMobileExtraSmall?'row':'column',justifyContent:isMobileExtraSmall?'space-evenly':'flex-start',children:children})});};const SideBar=()=>{const history=(0,react_router_dom_1.useHistory)();const {account}=(0,useTezos_1.useTezos)();const {pathname}=(0,react_router_dom_1.useLocation)();const daoId=(0,router_1.useDAOID)();const {data:dao}=(0,useDAO_1.useDAO)(daoId);const theme=(0,core_1.useTheme)();const isMobileExtraSmall=(0,core_1.useMediaQuery)(theme.breakpoints.down('xs'));const SIDE_BAR_ICONS=(0,react_1.useMemo)(()=>{if(!dao){return[];}const commonButons=[{Icon:home_svg_1.ReactComponent,handler:()=>history.push('/explorer/dao/'+daoId),name:'overview'},{Icon:voting_svg_1.ReactComponent,handler:()=>history.push(`/explorer/dao/${daoId}/proposals`),name:'proposals'},{Icon:treasury_svg_1.ReactComponent,handler:()=>history.push(`/explorer/dao/${daoId}/treasury`),name:'treasury'}];if(dao.data.type==='lambda'){if(account){return[...commonButons,{Icon:list_svg_1.ReactComponent,handler:()=>history.push(`/explorer/dao/${daoId}/registry`),name:'registry'},{Icon:user_svg_1.ReactComponent,handler:()=>history.push(`/explorer/dao/${daoId}/user`),name:'user'}];}return[...commonButons,{Icon:list_svg_1.ReactComponent,handler:()=>history.push(`/explorer/dao/${daoId}/registry`),name:'registry'}];}else{if(account){commonButons.push({Icon:user_svg_1.ReactComponent,handler:()=>history.push(`/explorer/dao/${daoId}/user`),name:'user'});}return commonButons;}},[account,dao,daoId,history]);return!isMobileExtraSmall?(0,jsx_runtime_1.jsx)(SideNavBar,{children:SIDE_BAR_ICONS.map(({Icon,handler,name})=>{return(0,jsx_runtime_1.jsx)(core_1.Grid,{item:true,children:(0,jsx_runtime_1.jsx)(ButtonIcon,{Icon:Icon,handler:handler,isSelected:pathname.includes(name)})},name);})}):(0,jsx_runtime_1.jsx)(BottomNavBar,{children:SIDE_BAR_ICONS.map(({Icon,handler,name})=>(0,jsx_runtime_1.jsx)(core_1.Grid,{item:true,children:(0,jsx_runtime_1.jsx)(ButtonIcon,{Icon:Icon,handler:handler,isSelected:pathname.includes(name)})},name))});};exports.SideBar=SideBar;