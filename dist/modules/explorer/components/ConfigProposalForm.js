'use strict';Object.defineProperty(exports,'__esModule',{value:true});exports.ConfigProposalForm=void 0;const jsx_runtime_1=require('react/jsx-runtime');const core_1=require('@material-ui/core');const react_1=require('react');const useDAO_1=require('../../../services/services/dao/hooks/useDAO');const ProposalFormSendButton_1=require('./ProposalFormSendButton');const react_hook_form_1=require('react-hook-form');const router_1=require('../pages/DAO/router');const ProposalFormInput_1=require('./ProposalFormInput');const useProposeConfigChange_1=require('../../../services/contracts/baseDAO/hooks/useProposeConfigChange');const ResponsiveDialog_1=require('./ResponsiveDialog');const ConfigProposalForm=({open,handleClose})=>{const daoId=(0,router_1.useDAOID)();const {data:dao}=(0,useDAO_1.useDAO)(daoId);const methods=(0,react_hook_form_1.useForm)();const {mutate}=(0,useProposeConfigChange_1.useProposeConfigChange)();const onSubmit=(0,react_1.useCallback)(values=>{if(dao){const mutateValues={frozen_extra_value:values.frozen_extra_value,slash_scale_value:!Number.isNaN(parseInt(values.returnedPercentage))?100-Number(values.returnedPercentage):NaN};Object.entries(mutateValues).map(([key,value])=>{if(Number.isNaN(value)){delete mutateValues[key];}});mutate({dao,args:mutateValues});methods.reset();handleClose();}},[dao,handleClose,methods,mutate]);return(0,jsx_runtime_1.jsx)(react_hook_form_1.FormProvider,Object.assign({},methods,{children:(0,jsx_runtime_1.jsx)(ResponsiveDialog_1.ResponsiveDialog,{open:open,onClose:handleClose,title:'Change DAO configuration',children:(0,jsx_runtime_1.jsxs)(core_1.Grid,{container:true,direction:'column',style:{gap:18},children:[(0,jsx_runtime_1.jsx)(core_1.Grid,{item:true,children:(0,jsx_runtime_1.jsx)(core_1.Typography,{style:{fontWeight:300,fontSize:'16px'},color:'secondary',children:'All fields are optional. Leave empty what you wish to leave unchanged'})}),(0,jsx_runtime_1.jsx)(core_1.Grid,{item:true,children:(0,jsx_runtime_1.jsx)(ProposalFormInput_1.ProposalFormInput,{label:`Proposal fee (Current: ${dao===null||dao===void 0?void 0:dao.data.extra.frozen_extra_value.toString()})`,children:(0,jsx_runtime_1.jsx)(react_hook_form_1.Controller,{control:methods.control,name:`frozen_extra_value`,render:({field})=>(0,jsx_runtime_1.jsx)(core_1.TextField,Object.assign({},field,{type:'number',placeholder:'Proposal fee',InputProps:{disableUnderline:true}}))})})}),(0,jsx_runtime_1.jsx)(core_1.Grid,{item:true,children:(0,jsx_runtime_1.jsx)(ProposalFormInput_1.ProposalFormInput,{label:`Percentage of tokens returned after rejection (Current:`,children:(0,jsx_runtime_1.jsx)(react_hook_form_1.Controller,{control:methods.control,name:`returnedPercentage`,render:({field})=>(0,jsx_runtime_1.jsx)(core_1.TextField,Object.assign({},field,{type:'number',placeholder:'Returned tokens percentage',InputProps:{disableUnderline:true}}))})})}),(0,jsx_runtime_1.jsxs)(core_1.Grid,{item:true,children:[(0,jsx_runtime_1.jsxs)(core_1.Typography,{align:'left',variant:'subtitle2',color:'textPrimary',display:'inline',children:['Proposal Fee:',' ']}),(0,jsx_runtime_1.jsxs)(core_1.Typography,{align:'left',variant:'subtitle2',color:'secondary',display:'inline',style:{fontWeight:300},children:[dao&&dao.data.extra.frozen_extra_value.toString(),' ',dao?dao.data.token.symbol:'']})]}),(0,jsx_runtime_1.jsx)(ProposalFormSendButton_1.SendButton,{onClick:methods.handleSubmit(onSubmit),disabled:!dao,children:'Submit'})]})})}));};exports.ConfigProposalForm=ConfigProposalForm;